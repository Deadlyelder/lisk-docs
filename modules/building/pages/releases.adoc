= Releasing new versions
:imagesdir: ../assets/images

:url_github_sdk_examples: https://github.com/LiskHQ/lisk-sdk-examples/tree/development

The steps that are necessary and/or recommended for updating the documentation to a new version are explained on this page.

== Explaining by example: Releasing the SDK 4.0.0 docs

This guide uses the release of the SDK 4.0.0 docs as an example to illustrate the general steps that need to be done for a new release on a practical level.
Lisk SDK version 3.0.2 is the previous latest version in this example.

NOTE: The steps explained here are not specific for the Lisk SDK docs and do also apply for other documentation components like `core`, `protocol` and `service`.

:sectnums:
:sectnumlevels: 2
[[preparing]]
== Preparing the new docs

=== Learning

Examples how to get knowledge about the new release:

* Get onboarded internally (if provided)
** via internal changelog
** via STMs
* Get onboarded on GitHub in the project description: https://github.com/LiskHQ/lisk-sdk/projects
** Read all LIPs carefully, which are linked in the project description
+
image:project-changelog.png[]
* Check the corresponding GitHub project: https://github.com/LiskHQ/lisk-sdk/projects/76
** Look at the epic issues
** Go down to the child issues and PRs of certain epics of needed

=== Setting up a new project in the lisk-docs repository

. Create a new project on lisk-docs for the new version: https://github.com/LiskHQ/lisk-docs/projects
* title: "Lisk SDK 4.0.0"
* description: follow the existing examples
//TODO: Create a section about creating issues in the styleguide
. xref:{}[Create issues] for all upcoming content changes in the docs and add them to the project.
New issues can still be added later, if necessary.

==== Major release

If a major version is released, a new content branch needs to be created for it.

Create a new branch `docs-sdk-3.0.2`, on the base of `docs-sdk`.
Like the version number indicates, this branch will store the docs that become outdated with the new release.

.lisk-docs/
[source,bash]
----
git checkout docs-sdk
git checkout -b docs-sdk-3.0.2
----

The branch `docs-sdk` will be used as base for the new documentation.
All issues created for the new version will be merged into this new branch.

To do so, bump the `version` in `antora.yml`:

.On branch `docs-sdk`
[source,yaml]
----
name: lisk-sdk
title: Lisk SDK
version: '4.0.0' <1>
display_version: '4.0.0' <2>
start_page: ROOT:index.adoc
nav:
- modules/ROOT/nav.adoc
----

<1> Bump to the latest version
<2> Change from `master` to the new version.
This will be changed back to `master` as one of the last steps before the new docs release.

== Content creation

//TODO: Add references to the contribution guides about issues, PRs, Reviews, Staging
The recommended order of updating the SDK docs is as follows:

. References
.. Update API specification
+
[source,bash]
----
cd lisk-sdk/framework/src/modules/http_api/schema
swagger2markup convert -i ./swagger.yml -d ~/swagger-spec
----
+
Then copy the content of the generated files and remove outdated links from the description.
.. Update Config reference
.. Update Lisk Commander reference
.. Update Lisk Elements reference
.. Update Lisk Framework reference
. Explanations
. Example applications
NOTE: These updates need to be done in the {url_github_sdk_examples}[lisk-sdk-examples^] repository.
. Tutorials
. Guides
. Changelog


== UI updates

Use `dev_antora` as base branch for all pull requests.
`dev_antora` is used in the {}[lisk-docs staging environment].

* Update top navigation in `src/partials/header-content.hbs`:
** Check, if any links are outdated and update or remove them.
** Check, if any new links should be added.
** If a new documentation component is released: The new component needs to be added to show dynamically in the top left.


== Release preparations

=== Updates on the previous version branch

[[update_previous]]
==== Update `antora.yml`

IMPORTANT: This needs to be updated at the same time as on the <<update_latest,latest version branch>>.

* Create a new issue to update the version of the previous version branch in `antora.yml`.
* Change `master` to `3.0.2`.
* Change `3.0.2 (latest)` to `3.0.2`.

==== Add versions in snippets

[source,bash]
----
#npm i lisk-sdk
npm i lisk-sdk@3.0.2
----

==== Update links to the SDK example apps

`https://github.com/LiskHQ/lisk-sdk-examples/tree/development/hello_world`
to
`https://github.com/LiskHQ/lisk-sdk-examples/tree/development/archive/3.x/hello_world`

=== Updates on the latest version branch

[[update_latest]]
==== Update `antora.yml`

IMPORTANT: This needs to be updated at the same time as on the <<update_previous,previous version branch>>.

* Change `4.0.0` to `master`.
* Change `4.0.0` to `4.0.0 (latest)`.

:!sectnums:
