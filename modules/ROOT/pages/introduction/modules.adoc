= Modules
Mona Bärenfänger <mona@lightcurve.io>
//Settings
:toc:
:idprefix:
:idseparator: -
:imagesdir: ../../assets/images
// External URLs
// Project URLs
:url_guides_genesis: guides/app-development/genesis-block.adoc
:url_explanations_communication: advanced-explanations/communication.adoc
:url_references_framework_application: references/lisk-framework/index.adoc#application
:url_references_framework_basemodule: references/lisk-framework/index.adoc#the-basemodule
:url_references_framework_baseasset: references/lisk-framework/index.adoc#the-baseasset
:url_dpos_module: references/lisk-framework/dpos-module.adoc
:url_keys_module: references/lisk-framework/keys-module.adoc
:url_sequence_module: references/lisk-framework/sequence-module.adoc
:url_token_module: references/lisk-framework/token-module.adoc

Modules hold all logic that is changing the state of the blockchain; or in other words, all logic that makes changes on the chain.

.When to create a custom module
[NOTE]
====
Modules enable to...

* define how data is stored on the blockchain
* define logic which is executed per block
* define logic which is executed per transaction
====

image:intro/module-asset.png[]

IMPORTANT: All of the logic implemented using a custom module / asset must be “deterministic” and executable within the block time.

//TODO: Update modules intro text

== The module class

//TODO: Update diagram
xref:{url_references_framework_basemodule}[BaseModule]

//TODO: Update module class description
The second part of modules enables to control the behaviour of the module.
The `BaseModule`, which every module extends from, offers various lifecycle hooks that allow each module to execute certain logic before or after transactions or blocks.
Also, it defines the logic for the transaction assets of the module.

=== Channel

=== Logger

== Interfaces
Modules can expose interfaces, which allow other components of the application to interact with the module.
Reducers are actions that can only be invoked by other modules of the application.
Actions and Events are exposed to the plugins and to external services.
More information about the exposed interface can be found in the section about the xref:{url_explanations_communication}[].

=== Accessing data from the blockchain
=== Actions
=== Events
=== Reducers
== State changes & execution logic

=== The state store

=== Transaction assets

Transaction assets contain all logic related to transactions that belong to the module.

.When to create a new asset
[NOTE]
====
Create a neew asset for every new transaction type that you want to use in the blockchain application.

Assets enable to...

* define a schema for data sent through transaction asset
* validate the data
* define logic which is executed per asset
====

== Lifecycle Hooks

=== beforeTransactionApply()
This hook is applied before each transaction.

The following parameters are available inside this hook:



=== afterTransactionApply()
This hook is applied after each transaction.

=== afterGenesisBlockApply()
This hook is applied after the genesis block.

=== beforeBlockApply()
This hookis applied before each block.

=== afterBlockApply()
This hook is applied after each block.



== Account schema
Modules define an account schema to store the module related data in the account.
The definition of this schema is totally flexible and it is possible to define very complex data structures as well, if needed.



== How to add a module to the application

Modules are registered in the file `src/app/modules.ts`.

[WARNING]
====
Registering a new module requires the generation of a new genesis block and therefore always results in a hardfork of the blockchain of the application.

Check out the xref:{url_guides_genesis}[Generating a genesis block] guide for more information on how to generate a new genesis block for your application.
====

.Example: How to register a module with the application in `modules.ts`
[source,typescript]
----
import { Application } from 'lisk-sdk';
import { SomeModule } from "some-module"; <1>

export const registerModules = (app: Application): void => {
    app.registerModule(SomeModule); <2>
};
----

<1> Import the module from an NPM package or from a local path.
<2> Add this line to register the module with the application.


